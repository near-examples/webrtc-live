{"version":3,"sources":["cat.jpg","rtc.js","App.js","index.js"],"names":["module","exports","Config","iceServers","url","OfferOptions","offerToReceiveAudio","offerToReceiveVideo","AnswerOptions","WebRTC","this","peerConnection","RTCPeerConnection","stream","getTracks","forEach","track","addTrack","callback","onicecandidate","candidate","a","localDescription","createOffer","offer","setLocalDescription","setRemoteDescription","createAnswer","answer","addEventListener","close","MediaConstraints","audio","video","App","props","_parseEncryptionKey","state","connected","signedIn","videoIsOn","streaming","accountId","connectingToRemote","streamingFrom","streamUrl","_streamUrl","viewers","live","muted","playing","_urlParsed","_initNear","then","setState","_accountId","_mounted","_parseUrl","_checkForAnswersTimeout","_alreadyPublishedAnswer","videoRef","React","createRef","streamUrlRef","oldWebrtcs","window","onbeforeunload","undefined","key","localStorage","getItem","buf","Buffer","from","length","nacl","secretKeyLength","Error","keyPair","fromSecretKey","setItem","secretKey","toString","_key","_streamKey","publicKey","_secretKey","URL","document","location","pathname","href","searchParams","append","p","URLSearchParams","search","get","_remoteKey","_remoteStreamKey","_contract","info","console","log","owner_id","_offer","remoteStream","JSON","parse","decryptSecretBox","connectToStream","badOffer","webrtc","addOnTrackListener","e","current","srcObject","streams","_stream","play","onplaying","pause","startStream","c","_lastAnswer","publishAnswer","receivingStream","_publishingAnswerInProgress","Promise","resolve","setTimeout","account_id","stopAnswering","published","encryptSecretBox","stringify","is_new","restream_key","indexOf","nearConfig","networkId","nodeUrl","contractName","walletUrl","keyStore","nearlib","BrowserLocalStorageKeyStore","Object","assign","deps","near","_keyStore","_nearConfig","_near","_walletConnection","getAccountId","_account","account","viewMethods","changeMethods","value","stateChange","requestSignIn","msg64","nonce","Uint8Array","nonceLength","copy","box","decodedBuf","open","str","fullBuf","set","isNew","_publishingInProgress","_lastOffer","publishOffer","checkForAnswers","clearTimeout","tookAnswer","addedViewer","oldViewers","concat","encryptedStream","onAnswer","take_answer","push","addStream","w","navigator","mediaDevices","getUserMedia","signOut","content","forceShow","defaultProfileUrl","Cat","className","onClick","logOut","style","margin","marginLeft","disabled","toggleMute","marginTop","initVideo","stopStream","stopVideo","ref","playsInline","type","id","readOnly","focus","select","role","aria-label","map","i","aria-hidden","Component","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.940a7549.chunk.js","sourcesContent":["module.exports = \"data:image/jpeg;base64,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\"","const Config = {\n    iceServers:[\n        {url: 'stun:stun.l.google.com:19302'},\n        {url: 'stun:stun.ekiga.net'},\n        {url: 'stun:stun.voxgratia.org'},\n        {url: 'stun:23.21.150.121'},\n    ]\n};\n\nconst OfferOptions = {\n    offerToReceiveAudio: 1,\n    offerToReceiveVideo: 1\n};\n\nconst AnswerOptions = {\n    offerToReceiveAudio: 0,\n    offerToReceiveVideo: 0,\n};\n\n\nexport default class WebRTC {\n    constructor() {\n        this.peerConnection = new RTCPeerConnection(Config);\n    }\n\n    addStream(stream) {\n        stream.getTracks().forEach(track => this.peerConnection.addTrack(track, stream));\n    }\n\n    async createOffer(callback) {\n        this.peerConnection.onicecandidate = async (candidate) => {\n            await callback(this.peerConnection.localDescription, candidate)\n        };\n        const offer = await this.peerConnection.createOffer(OfferOptions);\n        await this.peerConnection.setLocalDescription(offer);\n    }\n\n    async createAnswer(offer, callback) {\n        await this.peerConnection.setRemoteDescription(offer);\n        this.peerConnection.onicecandidate = async (candidate) => {\n            await callback(this.peerConnection.localDescription, candidate)\n        };\n        const answer = await this.peerConnection.createAnswer(AnswerOptions);\n        await this.peerConnection.setLocalDescription(answer);\n    }\n\n    async onAnswer(answer) {\n        await this.peerConnection.setRemoteDescription(answer);\n    }\n\n    addOnTrackListener(callback) {\n        this.peerConnection.addEventListener('track', callback);\n    }\n\n    close() {\n        this.peerConnection.close();\n    }\n}\n","import \"./App.css\";\nimport React from 'react';\nimport * as nearlib from 'nearlib';\nimport * as nacl from \"tweetnacl\";\nimport WebRTC from './rtc.js';\nimport { Profile } from 'metanear-react-components';\nimport Cat from './cat.jpg';\n\nconst ContractName = 'webrtc-live';\nconst StreamKey = 's';\n\nconst MediaConstraints = {\n  audio: true,\n  video: true\n};\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this._parseEncryptionKey()\n\n    this.state = {\n      connected: false,\n      signedIn: false,\n      videoIsOn: false,\n      streaming: false,\n      accountId: null,\n      connectingToRemote: false,\n      streamingFrom: null,\n      streamUrl: this._streamUrl,\n      viewers: [],\n      live: false,\n      muted: true,\n    };\n\n    this.playing = false;\n    this._urlParsed = false;\n\n    this._initNear().then(() => {\n      this.setState({\n        connected: true,\n        signedIn: !!this._accountId,\n        accountId: this._accountId,\n      })\n      if (this._mounted && this.state.signedIn) {\n        this._parseUrl();\n      }\n    })\n\n    this._checkForAnswersTimeout = false;\n    this._alreadyPublishedAnswer = false;\n\n    this.videoRef = React.createRef();\n    this.streamUrlRef = React.createRef();\n    this.oldWebrtcs = []\n\n    window.onbeforeunload = () => (this.state.streaming && !this.state.streamingFrom) || undefined;\n  }\n\n  /**\n   read private key from local storage\n   - if found, recreate the related key pair\n   - if not found, create a new key pair and save it to local storage\n   */\n  _parseEncryptionKey() {\n    const keyKey = \"enc_key:\";\n    let key = localStorage.getItem(keyKey);\n    if (key) {\n      const buf = Buffer.from(key, 'base64');\n      if (buf.length !== nacl.box.secretKeyLength) {\n        throw new Error(\"Given secret key has wrong length\");\n      }\n      key = nacl.box.keyPair.fromSecretKey(buf);\n    } else {\n      key = new nacl.box.keyPair();\n      localStorage.setItem(keyKey, Buffer.from(key.secretKey).toString('base64'));\n    }\n    this._key = key;\n    this._streamKey = Buffer.from(this._key.publicKey).toString('base64');\n    this._secretKey = Buffer.from(this._key.secretKey).toString('base64');\n    const url = new URL(document.location.pathname, document.location.href);\n    url.searchParams.append(StreamKey, this._secretKey);\n    this._streamUrl = url.toString();\n  }\n\n  async _parseUrl() {\n    if (this._urlParsed) {\n      return;\n    }\n    this._urlParsed = true;\n    let p = new URLSearchParams(document.location.search);\n    let key = p.get(StreamKey);\n    if (!key) {\n      return;\n    }\n    const buf = Buffer.from(key, 'base64');\n    if (buf.length !== nacl.box.secretKeyLength) {\n      throw new Error(\"Given secret key has wrong length\");\n    }\n    this._remoteKey = nacl.box.keyPair.fromSecretKey(buf);\n    this._remoteStreamKey = Buffer.from(this._remoteKey.publicKey).toString('base64');\n    const info = await this._contract.get({\n      key: this._remoteStreamKey,\n    });\n    if (info.offer) {\n      console.log(info)\n      this.setState({\n        streamingFrom: info.owner_id,\n      })\n      this._offer = info.offer;\n      const remoteStream = JSON.parse(this.decryptSecretBox(info.offer, this._remoteKey));\n      await this.connectToStream(remoteStream);\n    }\n  }\n\n  componentDidMount() {\n    this._mounted = true;\n    if (this.state.signedIn) {\n      this._parseUrl();\n    }\n  }\n\n  async connectToStream(offer) {\n    this.badOffer = false;\n    this.playing = false;\n    this.setState({\n      connectingToRemote: true,\n    });\n    this.webrtc = new WebRTC();\n    this.webrtc.addOnTrackListener((e) => {\n      console.log(\"got remote streams\", e);\n      if (this.videoRef.current.srcObject !== e.streams[0]) {\n        this._stream = e.streams[0];\n        this.videoRef.current.srcObject = e.streams[0];\n        this.videoRef.current.play();\n     }\n    });\n\n    this.videoRef.current.onplaying = async () => {\n      console.log(\"Playing\");\n      this.playing = true;\n      this.videoRef.current.onplaying = undefined;\n      if (this.badOffer) {\n        this.videoRef.current.pause();\n      } else {\n        await this.startStream(true);\n      }\n    };\n\n    await this.webrtc.createAnswer(offer, async (answer, c) => {\n      // console.log(\"On answer\", offer, c);\n      this._lastAnswer = answer;\n      await this.publishAnswer(answer);\n    })\n    this.setState({\n      receivingStream: true,\n    })\n  }\n\n  stopAnswering() {\n    this._publishingAnswerInProgress = false;\n    this.webrtc.close();\n    this.webrtc = null;\n    this.badOffer = true;\n    this.setState({\n      streamingFrom: false,\n    })\n  }\n\n  async publishAnswer(answer) {\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    if (this._publishingAnswerInProgress || answer !== this._lastAnswer || this.badOffer || this.playing) {\n      return;\n    }\n    this._publishingAnswerInProgress = true;\n    let info = await this._contract.get({\n      key: this._remoteStreamKey,\n    });\n    if (info.answer) {\n      if (info.answer.account_id !== this.state.accountId || info.offer !== this._offer || !this._alreadyPublishedAnswer) {\n        console.log(\"Bad offer\");\n        this.stopAnswering();\n        return;\n      }\n    }\n    console.log(\"Publishing answer\", answer);\n    let published = false;\n    try {\n      await this._contract.answer({\n        key: this._remoteStreamKey,\n        stream: this.encryptSecretBox(JSON.stringify(answer), this._remoteKey),\n        offer: this._offer,\n        is_new: !this._alreadyPublishedAnswer,\n        restream_key: this.encryptSecretBox(this._secretKey, this._remoteKey),\n      });\n      published = true;\n    } catch (e) {\n      console.log(\"Failed to publish answer\", e);\n      if (!this.playing && e.toString().indexOf(\"Smart contract panicked\") >= 0) {\n        this.stopAnswering();\n      }\n    }\n    this._publishingAnswerInProgress = false;\n    if (!this.playing && (!published || this._lastAnswer !== answer)) {\n      await this.publishAnswer(this._lastAnswer);\n    }\n  }\n\n\n  async _initNear() {\n    const nearConfig = {\n      networkId: 'default',\n      nodeUrl: 'https://rpc.nearprotocol.com',\n      contractName: ContractName,\n      walletUrl: 'https://wallet.nearprotocol.com',\n    };\n    const keyStore = new nearlib.keyStores.BrowserLocalStorageKeyStore();\n    const near = await nearlib.connect(Object.assign({ deps: { keyStore } }, nearConfig));\n    this._keyStore = keyStore;\n    this._nearConfig = nearConfig;\n    this._near = near;\n\n    this._walletConnection = new nearlib.WalletConnection(near, \"webrtc-live\");\n    this._accountId = this._walletConnection.getAccountId();\n\n    this._account = this._walletConnection.account();\n    this._contract = new nearlib.Contract(this._account, ContractName, {\n      viewMethods: ['get'],\n      changeMethods: ['offer', 'answer', 'take_answer'],\n    });\n  }\n\n  handleChange(key, value) {\n    const stateChange = {\n      [key]: value,\n    };\n    this.setState(stateChange);\n  }\n\n  async requestSignIn() {\n    const appTitle = 'WebRTC Live Streaming';\n    await this._walletConnection.requestSignIn(\n        ContractName,\n        appTitle\n    )\n  }\n\n  /**\n   unbox encrypted messages with our secret key\n   @param {string} msg64 encrypted message encoded as Base64\n   @return {string} decoded contents of the box\n   */\n  decryptSecretBox(msg64, key) {\n    const buf = Buffer.from(msg64, 'base64');\n    const nonce = new Uint8Array(nacl.secretbox.nonceLength);\n    buf.copy(nonce, 0, 0, nonce.length);\n    const box = new Uint8Array(buf.length - nacl.secretbox.nonceLength);\n    buf.copy(box, 0, nonce.length);\n    const decodedBuf = nacl.secretbox.open(box, nonce, key.secretKey);\n    return Buffer.from(decodedBuf).toString()\n  }\n\n  /**\n   box an unencrypted message with our secret key\n   @param {string} str the message to wrap in a box\n   @return {string} base64 encoded box of incoming message\n   */\n  encryptSecretBox(str, key) {\n    const buf = Buffer.from(str);\n    const nonce = nacl.randomBytes(nacl.secretbox.nonceLength);\n    const box = nacl.secretbox(buf, nonce, key.secretKey);\n\n    const fullBuf = new Uint8Array(box.length + nacl.secretbox.nonceLength);\n    fullBuf.set(nonce);\n    fullBuf.set(box, nacl.secretbox.nonceLength);\n    return Buffer.from(fullBuf).toString('base64')\n  }\n\n  async publishOffer(offer, isNew) {\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    if (this._publishingInProgress || offer !== this._lastOffer || !this.state.streaming) {\n      return;\n    }\n    let published = false;\n    this._publishingInProgress = true;\n    console.log(\"Publishing offer\", offer);\n    try {\n      await this._contract.offer({\n        key: this._streamKey,\n        offer: this.encryptSecretBox(JSON.stringify(offer), this._key),\n        is_new: isNew\n      });\n      published = true;\n    } catch(e) {\n      console.log(\"Failed to publish offer\", e)\n    }\n    this._publishingInProgress = false;\n    if (!published || this._lastOffer !== offer) {\n      await this.publishOffer(this._lastOffer, isNew);\n    } else {\n      this.setState({\n        live: true,\n      })\n      await this.checkForAnswers();\n    }\n  }\n\n  async checkForAnswers() {\n    if (this._checkForAnswersTimeout) {\n      clearTimeout(this._checkForAnswersTimeout);\n      this._checkForAnswersTimeout = null;\n    }\n\n    if (!this.state.streaming) {\n      return;\n    }\n\n    let tookAnswer = false;\n    let answer = null;\n    let addedViewer = false;\n    let oldViewers = false;\n    try {\n      let info = await this._contract.get({ key: this._streamKey });\n      if (info.answer) {\n        answer = info.answer;\n        console.log(\"Got answer\", answer);\n        oldViewers = this.state.viewers;\n        this.setState({\n          viewers: this.state.viewers.concat(answer.account_id),\n        });\n        addedViewer = true;\n        const encryptedStream = answer.stream;\n        if (encryptedStream) {\n          const remoteStream = JSON.parse(this.decryptSecretBox(encryptedStream, this._key));\n          await this.webrtc.onAnswer(remoteStream);\n        }\n        await this._contract.take_answer({ key: this._streamKey, answer });\n        tookAnswer = true;\n      }\n    } catch (e) {\n      console.log(\"Failed to get the answer\", e);\n    }\n\n    if (tookAnswer) {\n      await this.startStream(false);\n    } else {\n      this._checkForAnswersTimeout = setTimeout(() => this.checkForAnswers(), 1000);\n      if (addedViewer) {\n        this.setState({\n          viewers: oldViewers,\n        });\n      }\n    }\n  }\n\n  async startStream(isNew) {\n    if (this.webrtc) {\n      this.oldWebrtcs.push(this.webrtc);\n    }\n    this.webrtc = new WebRTC();\n    this.webrtc.addStream(this._stream);\n    this.setState({\n      streaming: true,\n    })\n    await this.webrtc.createOffer(async (offer, c) => {\n      // console.log(\"On offer\", offer, c);\n      this._lastOffer = offer;\n      await this.publishOffer(offer, isNew);\n    })\n  }\n\n  stopStream() {\n    if (this.state.streaming) {\n      this.webrtc && this.webrtc.close();\n      this.webrtc = null;\n      this.oldWebrtcs.forEach((w) => w.close());\n      this.oldWebrtcs = [];\n      this.setState({\n        streaming: false,\n      })\n      this._contract.offer({\n        key: this._streamKey,\n        offer: null,\n        is_new: true\n      });\n    }\n  }\n\n  stopVideo() {\n    if (this.state.videoIsOn) {\n      this.videoRef.current.pause();\n      this.setState({\n        videoIsOn: false,\n      })\n    }\n  }\n\n  async initVideo() {\n    const stream = await navigator.mediaDevices.getUserMedia(MediaConstraints);\n    this.videoRef.current.srcObject = stream;\n    this.videoRef.current.play();\n    this._stream = stream;\n\n    this.setState({\n      videoIsOn: true,\n    })\n  }\n\n  async logOut() {\n    this._walletConnection.signOut();\n    this._accountId = null;\n    this.setState({\n      signedIn: !!this._accountId,\n      accountId: this._accountId,\n    })\n  }\n\n  toggleMute() {\n    this.videoRef.current.muted = !this.videoRef.current.muted;\n    this.setState({\n      muted: this.videoRef.current.muted\n    })\n  }\n\n  render() {\n    const content = !this.state.connected ? (\n        <div>Connecting... <span className=\"spinner-grow spinner-grow-sm\" role=\"status\" aria-hidden=\"true\"></span></div>\n    ) : (this.state.signedIn ? (\n        <div>\n          Hi, <Profile accountId={this.state.accountId} forceShow={true} defaultProfileUrl={Cat}/>\n          <div className=\"float-right\">\n            <button\n                className=\"btn btn-outline-secondary\"\n                onClick={() => this.logOut()}>Log out</button>\n          </div>\n          {\n            this.state.streamingFrom ? (\n              <div style={{margin: \"1em 0\"}}>\n                {this.playing ? \"Streaming\" : \"Loading stream\"} from <Profile accountId={this.state.streamingFrom} forceShow={true} defaultProfileUrl={Cat}/>\n                {this.playing && <button\n                  className=\"btn btn-primary\"\n                  style={{marginLeft: \"1em\"}}\n                  disabled={!this.playing}\n                  onClick={() => this.toggleMute()}>\n                  {this.state.muted ? \"Unmute\" : \"Mute\"}\n                </button>}\n              </div>\n            ) : (\n                <div className=\"form-group\" style={{marginTop: \"1em\"}}>\n                  <div>\n                    <button\n                        className=\"btn btn-success\"\n                        disabled={this.state.videoIsOn || this.state.streamingFrom}\n                        onClick={() => this.initVideo()}>Initiate Local Video\n                    </button>\n                    <span> </span>\n                    <button\n                        className=\"btn btn-primary\"\n                        disabled={!this.state.videoIsOn || this.state.streamingFrom || this.state.streaming}\n                        onClick={() => this.startStream(true)}>Start streaming\n                    </button>\n                    <span> </span>\n                    <button\n                        className=\"btn btn-danger\"\n                        disabled={!this.state.videoIsOn || this.state.streamingFrom || !this.state.streaming}\n                        onClick={() => this.stopStream()}>Stop streaming\n                    </button>\n                    <span> </span>\n                    <button\n                        className=\"btn btn-danger\"\n                        disabled={!this.state.videoIsOn || this.state.streamingFrom || this.state.streaming}\n                        onClick={() => this.stopVideo()}>Stop video\n                    </button>\n                  </div>\n                </div>\n            )\n          }\n          <video className=\"local-video\" ref={this.videoRef} playsInline muted></video>\n          <div className=\"form-group\">\n            <div className=\"input-group\">\n              <div className=\"input-group-prepend\">\n                <div className=\"input-group-text\">Stream URL:</div>\n              </div>\n              <input type=\"text\"\n                     className=\"form-control from-large\"\n                     id=\"streamUrl\"\n                     ref={this.streamUrlRef}\n                     // disabled={true}\n                     value={this.state.streamUrl}\n                     readOnly\n                     onClick={() => {\n                       this.streamUrlRef.current.focus();\n                       this.streamUrlRef.current.select();\n                     }}\n              />\n            </div>\n          </div>\n          {\n            this.state.live && (\n              <div>\n                <h4><span role=\"img\" aria-label=\"red dot\">🔴</span> {this.state.streamingFrom ? \"Restreaming!\" : \"We're live!\"} List of Viewers</h4>\n                {\n                  this.state.viewers.map((accountId, i) => {\n                    return (\n                      <div key={'viewer-profile-' + accountId + ',' + i} >\n                        <Profile accountId={accountId} forceShow={true} defaultProfileUrl={Cat}/>\n                      </div>\n                    )\n                  })\n                }\n              </div>\n            )\n          }\n          </div>\n    ) : (\n        <div>\n          <button\n              className=\"btn btn-primary\"\n              onClick={() => this.requestSignIn()}>Log in with NEAR Wallet</button>\n        </div>\n    ));\n    return (\n        <div>\n          <h1>WebRTC Chat</h1>\n          {content}\n        </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}